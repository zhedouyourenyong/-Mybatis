参考邵发老师与黄勇老师的源代码完成